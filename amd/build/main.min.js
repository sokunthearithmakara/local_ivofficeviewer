define("local_ivofficeviewer/main",["exports","jquery","ivplugin_iframe/main"],(function(_exports,_jquery,_main){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Office viewer module
   *
   * @module     local_ivofficeviewer/main
   * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_jquery=_interopRequireDefault(_jquery),_main=_interopRequireDefault(_main);class OfficeViewer extends _main.default{renderContainer(annotation){(0,_jquery.default)("#message[data-id='".concat(annotation.id,"']")).addClass("hasiframe"),super.renderContainer(annotation)}async runInteraction(annotation){if(await this.player.pause(),!navigator.onLine)return this.addNotification("You need to be online to view this content."),void this.player.play();let self=this;await this.renderViewer(annotation),this.renderContainer(annotation),(async annotation=>{const data=await this.render(annotation,"html");if((0,_jquery.default)("#message[data-id='".concat(annotation.id,"'] .modal-body")).attr("id","content").html(data).fadeIn(300),0!=annotation.hascompletion&&!annotation.completed)return"view"==annotation.completiontracking?(this.postContentRender(annotation),void this.toggleCompletion(annotation.id,"mark-done","automatic")):void 0;this.postContentRender(annotation)})(annotation),"popup"==annotation.displayoptions&&(0,_jquery.default)("#annotation-modal").on("shown.bs.modal",(function(){self.setModalDraggable("#annotation-modal .modal-dialog")})),"manual"==annotation.completiontracking&&this.enableManualCompletion(annotation)}}return _exports.default=OfficeViewer,_exports.default}));

//# sourceMappingURL=main.min.js.map